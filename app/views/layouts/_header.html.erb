<!--
  Main sidebar seen on the left. may be static or collapsing depending on selected state.
    * Collapsing - navigation automatically collapse when mouse leaves it and expand when enters.
    * Static - stays always open.
-->
<script>
function time(){
var clock = document.getElementById("dt_now");
var now = new Date();
clock.innerHTML = now;
setTimeout("time()", 1000);
}
window.onload = function(){time()};
</script>

<nav id="sidebar" class="sidebar" role="navigation" >
    <!-- need this .js class to initiate slimscroll -->
    <div class="js-sidebar-content">
		
        <header class="logo hidden-xs" style="margin:5px 0 20px;height:35px;">
			<a href="<%= root_path %>">
            <img src="<%= asset_path "logo.gif" %>" width=45>
			</a>
        </header>
		
        <!-- seems like lots of recent admin template have this feature of user info in the sidebar.
             looks good, so adding it and enhancing with notifications -->
        <div class="sidebar-status visible-xs">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <span class="thumb-sm avatar" style="margin-right:10%">
                    <img class="img-circle" src="<%= asset_path "common/people/a5.jpg" %>">
                </span>
                <span style="font-size:15px"> &nbsp <%= current_user.uid %> &nbsp </span>
                <b class="caret" style="margin-left:3%"></b>
            </a>
            <!-- #notifications-dropdown-menu goes here when screen collapsed to xs or sm -->
        </div>
        <!-- main notification links are placed inside of .sidebar-nav -->
        <ul class="sidebar-nav">
            <li class="active">
                <!-- an example of nested submenu. basic bootstrap collapse component -->
                <a href="<%= dashboard_path %>"> <span class="icon">  <i class="fa fa-desktop"></i> </span> Dashboard </a>
            </li>
            <li>
                <a href="<%= messages_path %>"> <span class="icon"> <i class="fa fa-envelope"></i> </span> Email
                    <% if !@not_read.nil? && @not_read != 0 %>
                        <span class="label label-danger">
                            <%= @not_read %>
                        </span>
                    <% end %>
                </a>
            </li>
        </ul>
        <!-- every .sidebar-nav may have a title -->
        <h5 class="sidebar-nav-title">MailingList <a class="action-link" href="#"><i class="glyphicon glyphicon-refresh"></i></a></h5>
        <ul class="sidebar-nav">
            <% @groups.each_with_index do |group, index| %>
                <li>
                    <a class="collapsed" href="#sidebar-<%= group.id %>" data-toggle="collapse" data-parent="#sidebar">
                        <span class="icon">
                            <% case ( index % 6 ) %>
                            <% when 0 %> 
                            <i class="fa fa-circle text-danger mr-xs"></i>
                            <% when 1 %>
                            <i class="fa fa-circle text-warning mr-xs"></i>
                            <% when 2 %>
                            <i class="fa fa-circle text-success mr-xs"></i>
                            <% when 3 %>
                            <i class="fa fa-circle text-info mr-xs"></i>
                            <% when 4 %>
                            <i class="fa fa-circle text-primary mr-xs"></i>
                            <% when 5 %>
                            <i class="fa fa-circle text-gray mr-xs"></i>
                            <% end %>
                        </span>
                        <%= truncate(group.name, length: 15) %>
                        <i class="toggle fa fa-angle-down"></i>
                    </a>
                    <ul id="sidebar-<%= group.id %>" class="collapse">
                        <% group.channels.each do |channel| %>
                            <% if current_user.channels.include?(channel) %>
                            <li><a href="<%= mailinglist_path(channel) %>"><%= channel.name %></a></li>
                            <% end %>
                        <% end %>
                    </ul>
                </li>
            <% end %>
        </ul>
    </div>
</nav>
<!-- This is the white navigation bar seen on the top. A bit enhanced BS navbar. See .page-controls in _base.scss. -->
<% if user_signed_in? %>
<nav class="page-controls navbar navbar-default">
    <div class="container-fluid">
        <!-- .navbar-header contains links seen on xs & sm screens -->
        <div class="navbar-header">
            <ul class="nav navbar-nav">
                <li>
                    <!-- whether to automatically collapse sidebar on mouseleave. If activated acts more like usual admin templates -->
                    <a class="hidden-sm hidden-xs" id="nav-state-toggle" href="javascript:{};" title="Turn on/off sidebar static" data-placement="bottom">
                        <i class="fa fa-bars fa-lg"></i>
                    </a>
                    <!-- shown on xs & sm screen. collapses and expands navigation -->
                    <a class="visible-sm visible-xs" id="nav-collapse-toggle" href="javascript:{};" title="Show/hide sidebar" data-placement="bottom">
                        <span class="rounded rounded-lg bg-gray text-white visible-xs"><i class="fa fa-bars fa-lg"></i></span>
                        <i class="fa fa-bars fa-lg hidden-xs"></i>
                    </a>
                </li>
                <li class="ml-sm mr-n-xs hidden-xs"><a href="javascript:{};" onclick="document.location.reload();"><i class="fa fa-refresh fa-lg"></i></a></li>
				<li class="ml-sm mr-n-xs hidden-xs"><a href="javascript:{};" style="cursor:default"><div id="dt_now" style="font-size:13px;"></div></a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right visible-xs">
                <li>
                    <!-- toggles chat -->
                    <a href="#" data-toggle="chat-sidebar">
                        <span class="rounded rounded-lg bg-gray text-white"><i class="fa fa-globe fa-lg"></i></span>
                    </a>
                </li>
            </ul>
            <!-- xs & sm screen logo -->
            <a class="navbar-brand visible-xs" href="<%= root_path %>"> Tongsu </a>
        </div>

        <!-- this part is hidden for xs screens -->
        <div class="collapse navbar-collapse">
            <!-- Session -->
            <% if user_signed_in? %>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a style="background-color:#F6F6F6" >
                        <span class="thumb-sm avatar pull-left">
                            <img class="img-circle" src="<%= asset_path "common/people/a5.jpg" %>">
                        </span>
                        <span style="font-size:15px"> &nbsp <%= current_user.uid %> &nbsp </span>
						</a>
                </li>
				<li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-cog fa-lg"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="<%= edit_user_registration_path %>"><i class="glyphicon glyphicon-user"></i> &nbsp; My Account</a></li>
                        <li><a href="<%= new_import_path %>"><i class="glyphicon glyphicon-envelope"></i> &nbsp; Importing</a></li>
                        <li class="divider"></li>
                        <li><%= link_to "<i class='glyphicon glyphicon-remove-circle'></i> &nbsp; Sign out".html_safe, destroy_user_session_path, method: :delete, data: { confirm: "Are you sure you want to logout?" } %></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="javascript:{};" class="dropdown-toggle dropdown-toggle-notifications" id="notifications-dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-globe fa-lg"></i>
                    </a>
                    <div class="dropdown-menu animated fadeInUp" id="notifications-dropdown-menu">
                        <section class="panel notifications">
                            <header class="panel-heading">
                                <div class="text-align-center mb-sm">
                                    <strong>You have 13 notifications</strong>
                                </div>
                            </header>
                            <!-- notification list with .thin-scroll which styles scrollbar for webkit -->
                            <div id="notifications-list" class="list-group thin-scroll">
                                <div class="list-group-item">
                                    <span class="thumb-sm pull-left mr clearfix">
                                        <img class="img-circle" src="demo/img/people/a3.jpg" alt="...">
                                    </span>
                                    <p class="no-margin overflow-hidden">
                                        1 new user just signed up! Check out
                                        <a href="#">Monica Smith</a>'s account.
                                        <time class="help-block no-margin">
                                            2 mins ago
                                        </time>
                                    </p>
                                </div>
                                <a class="list-group-item" href="#">
                                    <span class="thumb-sm pull-left mr">
                                        <i class="glyphicon glyphicon-upload fa-lg"></i>
                                    </span>
                                    <p class="text-ellipsis no-margin">
                                        2.1.0-pre-alpha just released. </p>
                                    <time class="help-block no-margin">
                                        5h ago
                                    </time>
                                </a>
                                <a class="list-group-item" href="#">
                                    <span class="thumb-sm pull-left mr">
                                        <i class="fa fa-bolt fa-lg"></i>
                                    </span>
                                    <p class="text-ellipsis no-margin">
                                        Server load limited. </p>
                                    <time class="help-block no-margin">
                                        7h ago
                                    </time>
                                </a>
                                <div class="list-group-item">
                                    <span class="thumb-sm pull-left mr clearfix">
                                        <img class="img-circle" src="demo/img/people/a5.jpg" alt="...">
                                    </span>
                                    <p class="no-margin overflow-hidden">
                                        User <a href="#">Jeff</a> registered
                                        &nbsp;&nbsp;
                                        <button class="btn btn-xs btn-success">Allow</button>
                                        <button class="btn btn-xs btn-danger">Deny</button>
                                        <time class="help-block no-margin">
                                            12:18 AM
                                        </time>
                                    </p>
                                </div>
                                <div class="list-group-item">
                                    <span class="thumb-sm pull-left mr">
                                        <i class="fa fa-shield fa-lg"></i>
                                    </span>
                                    <p class="no-margin overflow-hidden">
                                        Instructions for changing your Envato Account password. Please
                                        check your account <a href="#">security page</a>.
                                        <time class="help-block no-margin">
                                            12:18 AM
                                        </time>
                                    </p>
                                </div>
                                <a class="list-group-item" href="#">
                                    <span class="thumb-sm pull-left mr">
                                        <span class="rounded bg-primary rounded-lg">
                                            <i class="fa fa-facebook text-white"></i>
                                        </span>
                                    </span>
                                    <p class="text-ellipsis no-margin">
                                        New <strong>76</strong> facebook likes received.</p>
                                    <time class="help-block no-margin">
                                        15 Apr 2014
                                    </time>
                                </a>
                                <a class="list-group-item" href="#">
                                    <span class="thumb-sm pull-left mr">
                                        <span class="circle circle-lg bg-gray-dark">
                                            <i class="fa fa-circle-o text-white"></i>
                                        </span>
                                    </span>
                                    <p class="text-ellipsis no-margin">
                                        Dark matter detected.</p>
                                    <time class="help-block no-margin">
                                        15 Apr 2014
                                    </time>
                                </a>
                            </div>
                            <footer class="panel-footer text-sm">
                                <!-- ajax-load button. loads demo/ajax/notifications.php to #notifications-list
                                     when clicked -->
                                <button class="btn btn-xs btn-link pull-right"
                                        id="load-notifications-btn"
                                        data-ajax-load="demo/ajax/notifications.php"
                                        data-ajax-target="#notifications-list"
                                        data-loading-text="<i class='fa fa-refresh fa-spin mr-xs'></i> Loading...">
                                    <i class="fa fa-refresh"></i>
                                </button>
                                <span class="fs-mini">Synced at: 21 Apr 2014 18:36</span>
                            </footer>
                        </section>
                    </div>
                </li>
            </ul>
            <% else %>
            <div class="nav navbar-nav navbar-right" style="margin-right:150px; padding-top:7px; font-size:14px;">
                <button class="btn btn-inverse" onclick="location.href="<%= new_user_session_path %>"">&nbsp Login &nbsp</button>
            </div>
            <% end %>
<!-- Session -->
        </div>
    </div>
</nav>
<% end %>